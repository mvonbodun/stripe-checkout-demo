<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkAuthenticationElement Email Validation Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #635bff;
            padding-bottom: 10px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #635bff;
        }
        .email-example {
            background: #e3f2fd;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: 'Monaco', 'Courier New', monospace;
            border-left: 3px solid #2196f3;
        }
        .valid {
            border-left-color: #4caf50;
            background: #e8f5e8;
        }
        .invalid {
            border-left-color: #f44336;
            background: #ffebee;
        }
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
        }
        .code {
            background: #f1f1f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: 'Monaco', 'Courier New', monospace;
            margin: 10px 0;
        }
        .link {
            color: #635bff;
            text-decoration: none;
            font-weight: bold;
        }
        .link:hover {
            text-decoration: underline;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .valid-indicator { background: #4caf50; }
        .invalid-indicator { background: #f44336; }
        .button-demo {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            margin: 5px;
            cursor: pointer;
        }
        .enabled { background: #635bff; color: white; }
        .disabled { background: #ccc; color: #666; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê LinkAuthenticationElement Email Validation</h1>
        
        <div class="instructions">
            <h3>üìã Testing Instructions</h3>
            <ol>
                <li>Navigate to <a href="http://localhost:3001/checkout" class="link">http://localhost:3001/checkout</a></li>
                <li>Add items to cart first if cart is empty</li>
                <li>Open browser console (F12 ‚Üí Console)</li>
                <li>Test email validation by typing in the email field</li>
                <li>Watch console logs and Pay button state changes</li>
            </ol>
        </div>

        <div class="test-section">
            <h3>üìß Email Validation Test Cases</h3>
            
            <h4>‚úÖ Valid Emails (should enable Pay button):</h4>
            <div class="email-example valid">
                <span class="status-indicator valid-indicator"></span>
                user@example.com
            </div>
            <div class="email-example valid">
                <span class="status-indicator valid-indicator"></span>
                test.email@domain.co.uk
            </div>
            <div class="email-example valid">
                <span class="status-indicator valid-indicator"></span>
                valid+tag@test-domain.org
            </div>

            <h4>‚ùå Invalid Emails (should disable Pay button):</h4>
            <div class="email-example invalid">
                <span class="status-indicator invalid-indicator"></span>
                (empty field)
            </div>
            <div class="email-example invalid">
                <span class="status-indicator invalid-indicator"></span>
                user@
            </div>
            <div class="email-example invalid">
                <span class="status-indicator invalid-indicator"></span>
                user@domain
            </div>
            <div class="email-example invalid">
                <span class="status-indicator invalid-indicator"></span>
                @domain.com
            </div>
            <div class="email-example invalid">
                <span class="status-indicator invalid-indicator"></span>
                user domain@test.com
            </div>
        </div>

        <div class="test-section">
            <h3>üîç What to Look For</h3>
            
            <h4>Console Output:</h4>
            <div class="code">
üìß LinkAuthentication changed: {
  complete: true,
  email: "user@example.com"
}
            </div>

            <h4>Visual Feedback:</h4>
            <p><span style="color: #16a085;">‚úì Email is valid</span> (when complete = true)</p>
            <p><span style="color: #f39c12;">‚ö† Please enter a valid email address</span> (when complete = false)</p>

            <h4>Pay Button States:</h4>
            <button class="button-demo enabled">Pay $42.99</button> ‚Üê Enabled (valid email)
            <button class="button-demo disabled">Pay $42.99</button> ‚Üê Disabled (invalid email)
        </div>

        <div class="test-section">
            <h3>üõ† Implementation Details</h3>
            
            <h4>Event Properties:</h4>
            <ul>
                <li><strong>event.complete</strong> - Boolean indicating email validation state</li>
                <li><strong>event.value.email</strong> - Current email string value</li>
            </ul>

            <h4>Pay Button Logic:</h4>
            <div class="code">
disabled={!stripe || loading || isUpdatingPaymentIntent || !emailComplete}
            </div>

            <h4>State Management:</h4>
            <div class="code">
const [emailComplete, setEmailComplete] = useState(false);

onChange={event => {
  setEmail(event.value.email);
  setEmailComplete(event.complete);
}}
            </div>
        </div>

        <div class="instructions">
            <h3>üöÄ Browser Console Testing</h3>
            <p>Load <strong>/test-email-validation.js</strong> in browser console for additional testing functions:</p>
            <div class="code">
// In browser console:
testEmailValidation()      // Show test cases
checkPayButtonState()      // Check current Pay button state  
monitorEmailValidation()   // Monitor validation for 30 seconds
            </div>
        </div>

        <div class="test-section">
            <h3>üìä Expected Behavior Summary</h3>
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f1f1f1;">
                        <th style="padding: 10px; border: 1px solid #ddd;">Email Input</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">event.complete</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">Pay Button</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">Feedback</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;">(empty)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">false</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Disabled</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">No feedback</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;">user@</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">false</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Disabled</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">‚ö† Please enter valid email</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;">user@domain.com</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">true</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Enabled</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">‚úì Email is valid</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
            <p><strong>Ready to test!</strong> Open the <a href="http://localhost:3001/checkout" class="link">checkout page</a> and start typing emails.</p>
        </div>
    </div>
</body>
</html>
